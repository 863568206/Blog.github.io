---
layout:     post
title:      路径选择窗口
subtitle:   QT
date:       2019-07-26
author:     YiMiTuMi
header-img: 
catalog: true
tags:
    - c++
---
# BROWSEINFO的使用

在应用软件的时候我们经能够看到让我们选择文件路径的窗口，主要是通过结构体[BROWSEINFO](https://docs.microsoft.com/zh-cn/windows/win32/api/shlobj_core/ns-shlobj_core-browseinfoa)和函数[SHBrowseForFolder](https://docs.microsoft.com/zh-cn/windows/win32/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera)实现的：

&emsp; &emsp; &emsp; &emsp; &emsp; &emsp; ![路径选择窗口](/img/b1.png)

通用：

	BROWSEINFO  bi;
	bi.hwndOwner = NULL;
	bi.pidlRoot = CSIDL_DESKTOP;//文件夹的根目录，此处为桌面
	bi.pszDisplayName  = NULL;	
	bi.lpszTitle = NULL;//显示位于对话框左上部的提示信息
	bi.ulFlags = BIF_DONTGOBELOWDOMAIN | BIF_RETURNONLYFSDIRS BIF_NEWDIALOGSTYLE;//有新建文件夹按钮
	bi.lpfn = NULL; 
	bi.iImage = 0;
	LPITEMIDLIST pidl = SHBrowseForFolder(&bi);//调用选择对话框
	if (pidl == NULL)    
	{    
		return strPath;    
	}    
	TCHAR strFolder[1024];   
	SHGetPathFromIDList(pidl,strFolder );

QT实现：

	void MainWindow::on_pushButton_clicked()
	{
	    BROWSEINFO	bInfo = { 0 };
	    bInfo.hwndOwner = NULL;
	    bInfo.lpszTitle = TEXT("选择路径");
	    bInfo.ulFlags = BIF_BROWSEFORCOMPUTER | BIF_DONTGOBELOWDOMAIN|BIF_RETURNONLYFSDIRS;
	    LPITEMIDLIST pItemList = ::SHBrowseForFolder(&bInfo);
	    TCHAR strFolder[1024];
	    SHGetPathFromIDList(pItemList, strFolder);
	    ui->label->setText(QString::fromWCharArray(strFolder));
	}

![]()

![]()

![]()

## 格桑花--聆取眼前人
